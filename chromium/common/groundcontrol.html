<html>
  <head>
    <title>GroundControl</title>
    <script src="jquery/jquery-1.4.2.min.js"></script>
    <script src="functions.js"></script>
    <script src="cloudservers/service.js"></script>
    <script src="cloudservers/faults.js"></script>
    <script src="cloudservers/entitymanager.js"></script>
    <script src="cloudservers/servermanager.js"></script>
    <script>
      $(function() {
        var client = com.rackspace.cloud.servers.api.client;
        service = new client.CloudServersService({
          username: "gundlach",
          apiKey: "c36ec1e44e2e2947f8e155a3a122a358"
        });
        $("#it").text("'service' object authenticated.");
        servers = service.createServerManager();

        $("<button>").text("Fetch").appendTo("body").click(function() {
          servers.find({
            id:186199, 
            success:function(entity) {
              $("#it").append("Fetched " + entity.id + " OK.");
              theEntity = entity;
            },
            fault: function(fault) {
              console.log("FAULT fetching: " + JSON.stringify(fault));
            }
          });
        }).after("<br/>");

        $("<button>").text("Refresh").appendTo("body").click(function() {
          servers.refresh({
            entity:theEntity,
            success:function(entity) {
              theEntity = entity;
              $("#it").append("Refreshed " + entity.id + " OK.");
            },
            fault: function(fault) {
              console.log("FAULT refreshing: " + JSON.stringify(fault));
            }
          });
        }).after("<br/>");

        $("<input id='newName'>").appendTo("body");

        $("<button>").text("Update").appendTo("body").click(function() {
          theEntity.name = $("#newName").val();
          servers.update({
            entity:theEntity,
            success:function(entity) {
              theEntity = entity;
              $("#it").append("Updated " + entity.name + " OK.");
            },
            fault: function(fault) {
              console.log("FAULT updating: " + JSON.stringify(fault));
            }
          });
        }).after("<br/>");

      });
    </script>
  </head>
  <body>
    <div id="it"></div>
  </body>
</html>

